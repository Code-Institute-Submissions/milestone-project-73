{"changed":true,"filter":false,"title":"app.py","tooltip":"/app.py","value":"import os\nif os.path.exists(\"env.py\"):\n  import env \nfrom flask import Flask, render_template, redirect, request, url_for, flash, session\nfrom forms import LoginForm, RegisterForm, ReviewGameForm\nfrom flask_pymongo import PyMongo\nfrom bson.objectid import ObjectId \nimport re\nimport bcrypt\n\napp = Flask(__name__)\napp.config[\"MONGO_DBNAME\"] = 'game_scan'\napp.config[\"MONGO_URI\"] = os.environ.get('MONGO_URI')\n\nmongo = PyMongo(app)\n\nSECRET_KEY = os.urandom(32)\napp.config['SECRET_KEY'] = SECRET_KEY\n\n\n\n@app.route('/reviews')\ndef reviews():\n    return render_template('reviews.html', title=\"Read a review!\", game_reviews=mongo.db.game_reviews.find())\n    \n\n\n\n\n\n\n@app.route('/')\ndef index():\n    return render_template('index.html', title=\"Home\")\n\n\n\n\n\n\n# Adding Log in\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login handler\"\"\"\n    if session.get('logged_in'):\n        if session['logged_in'] is True:\n            return redirect(url_for('index', title=\"Log In\"))\n\n    form = LoginForm()\n\n    if form.validate_on_submit():\n        # get all users\n        users = mongo.db.users\n        # try and get one with same name as entered\n        db_user = users.find_one({'name': request.form['username']})\n\n        if db_user:\n            # check password using hashing\n            if bcrypt.hashpw(request.form['password'].encode('utf-8'),\n                             db_user['password']) == db_user['password']:\n                session['username'] = request.form['username']\n                session['logged_in'] = True\n                # successful redirect to home logged in\n                return redirect(url_for('index', title=\"Sign In\", form=form))\n            # must have failed set flash message\n            flash('Invalid username/password combination')\n    return render_template(\"login.html\", title=\"Sign In\", form=form)\n\n\n\n\n\n@app.route('/logout')\ndef logout():\n    \"\"\"Clears session and redirects to home\"\"\"\n    session.clear()\n    return redirect(url_for('index'))\n\n\n\n\n\n# Adding in Register form\n\n@app.route('/register', methods=['GET', 'POST'])\ndef register():\n    \"\"\"Handles registration functionality\"\"\"\n    form = RegisterForm(request.form)\n    if form.validate_on_submit():\n        # get all the users\n        users = mongo.db.users\n        # see if we already have the entered username\n        existing_user = users.find_one({'name': request.form['username']})\n\n        if existing_user is None:\n            # hash the entered password\n            hash_pass = bcrypt.hashpw(request.form['password'].encode('utf-8'), bcrypt.gensalt())\n            # insert the user to DB\n            users.insert_one({'name': request.form['username'],\n                          'password': hash_pass,\n                          'email': request.form['email']})\n            session['username'] = request.form['username']\n            session['logged_in'] = True\n            # Logs user in after registering\n            return redirect(url_for('index'))\n        # duplcate username set flash message and reload page\n        flash('Sorry, that username is already taken - use another')\n        return redirect(url_for('register'))\n    return render_template('register.html', title='Register', form=form)\n\n\n\n\n\n# Adding a review\n\n@app.route('/addreview', methods=['GET', 'POST'])\ndef addreview():\n\n   # If user gets onto the add page but not logged in\n\n    if 'logged_in' not in session:\n        flash('To add a review you need to sign in', 'warning')\n        return redirect(url_for('login'))\n\n   # If form submits successfully\n    \n    form = ReviewGameForm(request.form)\n    if request.method == 'POST':\n        game_reviews=mongo.db.game_reviews\n        print('inside')\n        print('rating:' + request.form['rating'])\n        # import pdb; pdb.set_trace()\n        # add form content to db as a new record\n        game_reviews.insert_one({\n            'user_created': session['username'],\n            'name': request.form['name'],\n            'genre': request.form['genre'],\n            'rating': request.form['rating'],\n            'description': request.form['description'],\n            })\n        \n        flash('Your Review has been added ', 'success')\n\n        # send to my reviews template on successful add\n        return redirect(url_for('reviews'))\n\n    return render_template('addreview.html', form=form,\n                           title='Add a Review')\n\n\n\n\n\n# Editing a review\n\n@app.route('/editreview/<id>', methods=['GET', 'POST'])\ndef editreview(id):\n    \n\n    a_reivew = mongo.db.game_reviews.find_one({'_id': ObjectId(id)})\n    # retrieving record from db\n\n\n    form = ReviewGameForm(data=a_reivew)\n\n    if form.validate_on_submit():  # if form submits successfully\n        game_reviews = mongo.db.game_reviews\n\n\n        # add form content to db as a new record\n        game_reviews.update_one({'_id': ObjectId(id)}, {'$set': {\n            'name': request.form['name'],\n            'genre': request.form['genre'],\n            'rating': request.form['rating'],\n            'description': request.form['description'],\n            }})\n        flash('Your review has been updated!', 'success')\n\n        # send to my review template on successful addupdate\n        return redirect(url_for('reviews', id=id))\n\n    return render_template('editreview.html', form=form,\n                           title='Edit a  Review!')\n\n    \n# Delete a review\n\n# If user is logged in and wants to delete a review\n\n@app.route('/deletereview/<id>', methods=['GET', 'POST'])\ndef deletereview(id):\n\n    flash(\"Your review has been removed!.\")\n    mongo.db.game_reviews.delete_one({'_id': ObjectId(id)})\n    return redirect(url_for('index'))\n\n# Adding a Search bar to my reviews page\n\n\n@app.route('/search', methods=['POST'])\ndef search():\n    \n\n\n\n# Adding a 404 error page\n\n@app.errorhandler(404)\ndef handle_404(exception):\n    return render_template('404.html', exception=exception)\n\nif __name__ == '__main__':\n    app.run(host=os.environ.get('IP'),\n            port=int(os.environ.get('PORT')),\n            debug=True)","undoManager":{"mark":98,"position":100,"stack":[[{"start":{"row":158,"column":33},"end":{"row":158,"column":34},"action":"insert","lines":[" "],"id":45},{"start":{"row":158,"column":34},"end":{"row":158,"column":35},"action":"insert","lines":["e"]},{"start":{"row":158,"column":35},"end":{"row":158,"column":36},"action":"insert","lines":["d"]},{"start":{"row":158,"column":36},"end":{"row":158,"column":37},"action":"insert","lines":["i"]},{"start":{"row":158,"column":37},"end":{"row":158,"column":38},"action":"insert","lines":["t"]}],[{"start":{"row":158,"column":38},"end":{"row":158,"column":39},"action":"insert","lines":[" "],"id":46},{"start":{"row":158,"column":39},"end":{"row":158,"column":40},"action":"insert","lines":["a"]}],[{"start":{"row":158,"column":39},"end":{"row":158,"column":40},"action":"remove","lines":["a"],"id":47}],[{"start":{"row":158,"column":39},"end":{"row":158,"column":40},"action":"insert","lines":["p"],"id":48},{"start":{"row":158,"column":40},"end":{"row":158,"column":41},"action":"insert","lines":["a"]},{"start":{"row":158,"column":41},"end":{"row":158,"column":42},"action":"insert","lines":["g"]},{"start":{"row":158,"column":42},"end":{"row":158,"column":43},"action":"insert","lines":["e"]}],[{"start":{"row":158,"column":43},"end":{"row":158,"column":44},"action":"insert","lines":[" "],"id":49},{"start":{"row":158,"column":44},"end":{"row":158,"column":45},"action":"insert","lines":["o"]},{"start":{"row":158,"column":45},"end":{"row":158,"column":46},"action":"insert","lines":["r"]}],[{"start":{"row":158,"column":46},"end":{"row":158,"column":47},"action":"insert","lines":[" "],"id":50},{"start":{"row":158,"column":47},"end":{"row":158,"column":48},"action":"insert","lines":["t"]},{"start":{"row":158,"column":48},"end":{"row":158,"column":49},"action":"insert","lines":["r"]},{"start":{"row":158,"column":49},"end":{"row":158,"column":50},"action":"insert","lines":["y"]}],[{"start":{"row":158,"column":50},"end":{"row":158,"column":51},"action":"insert","lines":[" "],"id":51},{"start":{"row":158,"column":51},"end":{"row":158,"column":52},"action":"insert","lines":["f"]},{"start":{"row":158,"column":52},"end":{"row":158,"column":53},"action":"insert","lines":["i"]},{"start":{"row":158,"column":53},"end":{"row":158,"column":54},"action":"insert","lines":["n"]},{"start":{"row":158,"column":54},"end":{"row":158,"column":55},"action":"insert","lines":["d"]}],[{"start":{"row":158,"column":55},"end":{"row":158,"column":56},"action":"insert","lines":[" "],"id":52},{"start":{"row":158,"column":56},"end":{"row":158,"column":57},"action":"insert","lines":["a"]},{"start":{"row":158,"column":57},"end":{"row":158,"column":58},"action":"insert","lines":["w"]},{"start":{"row":158,"column":58},"end":{"row":158,"column":59},"action":"insert","lines":["a"]},{"start":{"row":158,"column":59},"end":{"row":158,"column":60},"action":"insert","lines":["y"]}],[{"start":{"row":158,"column":60},"end":{"row":158,"column":61},"action":"insert","lines":[" "],"id":53},{"start":{"row":158,"column":61},"end":{"row":158,"column":62},"action":"insert","lines":["f"]}],[{"start":{"row":158,"column":61},"end":{"row":158,"column":62},"action":"remove","lines":["f"],"id":54}],[{"start":{"row":158,"column":61},"end":{"row":158,"column":62},"action":"insert","lines":["r"],"id":55},{"start":{"row":158,"column":62},"end":{"row":158,"column":63},"action":"insert","lines":["o"]},{"start":{"row":158,"column":63},"end":{"row":158,"column":64},"action":"insert","lines":["u"]},{"start":{"row":158,"column":64},"end":{"row":158,"column":65},"action":"insert","lines":["n"]},{"start":{"row":158,"column":65},"end":{"row":158,"column":66},"action":"insert","lines":["g"]}],[{"start":{"row":158,"column":66},"end":{"row":158,"column":67},"action":"insert","lines":[" "],"id":56},{"start":{"row":158,"column":67},"end":{"row":158,"column":68},"action":"insert","lines":["t"]},{"start":{"row":158,"column":68},"end":{"row":158,"column":69},"action":"insert","lines":["h"]},{"start":{"row":158,"column":69},"end":{"row":158,"column":70},"action":"insert","lines":["e"]}],[{"start":{"row":158,"column":70},"end":{"row":158,"column":71},"action":"insert","lines":[" "],"id":57},{"start":{"row":158,"column":71},"end":{"row":158,"column":72},"action":"insert","lines":["e"]},{"start":{"row":158,"column":72},"end":{"row":158,"column":73},"action":"insert","lines":["d"]},{"start":{"row":158,"column":73},"end":{"row":158,"column":74},"action":"insert","lines":["i"]},{"start":{"row":158,"column":74},"end":{"row":158,"column":75},"action":"insert","lines":["t"]}],[{"start":{"row":158,"column":75},"end":{"row":158,"column":76},"action":"insert","lines":[" "],"id":58},{"start":{"row":158,"column":76},"end":{"row":158,"column":77},"action":"insert","lines":["t"]}],[{"start":{"row":158,"column":76},"end":{"row":158,"column":77},"action":"remove","lines":["t"],"id":59}],[{"start":{"row":158,"column":76},"end":{"row":158,"column":77},"action":"insert","lines":["a"],"id":60},{"start":{"row":158,"column":77},"end":{"row":158,"column":78},"action":"insert","lines":["p"]}],[{"start":{"row":158,"column":77},"end":{"row":158,"column":78},"action":"remove","lines":["p"],"id":61},{"start":{"row":158,"column":76},"end":{"row":158,"column":77},"action":"remove","lines":["a"]}],[{"start":{"row":158,"column":76},"end":{"row":158,"column":77},"action":"insert","lines":["p"],"id":62},{"start":{"row":158,"column":77},"end":{"row":158,"column":78},"action":"insert","lines":["a"]},{"start":{"row":158,"column":78},"end":{"row":158,"column":79},"action":"insert","lines":["g"]},{"start":{"row":158,"column":79},"end":{"row":158,"column":80},"action":"insert","lines":["e"]}],[{"start":{"row":158,"column":0},"end":{"row":158,"column":80},"action":"remove","lines":["''' If users somehow get onto the edit page or try find away roung the edit page"],"id":63},{"start":{"row":157,"column":4},"end":{"row":158,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":159,"column":3},"end":{"row":163,"column":62},"action":"remove","lines":[" if 'logged_in' not in session:","        # if a user trys to go to edit review without been logged in","","        flash('You will need to log in to edit a review', 'warning')","        return redirect(url_for('login'))  # sending to log in"],"id":64},{"start":{"row":159,"column":2},"end":{"row":159,"column":3},"action":"remove","lines":[" "]},{"start":{"row":159,"column":1},"end":{"row":159,"column":2},"action":"remove","lines":[" "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":1},"action":"remove","lines":[" "]},{"start":{"row":158,"column":0},"end":{"row":159,"column":0},"action":"remove","lines":["",""]},{"start":{"row":157,"column":4},"end":{"row":158,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":162,"column":3},"end":{"row":166,"column":62},"action":"remove","lines":[" # if a user trys to go to edit review that they don't own","    if a_reivew['user_created'] != session['username']:","        flash('You do  not own this review and cannot edit it. ',","              'warning')","        return redirect(url_for('login'))  # sending to log in"],"id":65},{"start":{"row":162,"column":2},"end":{"row":162,"column":3},"action":"remove","lines":[" "]},{"start":{"row":162,"column":1},"end":{"row":162,"column":2},"action":"remove","lines":[" "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":1},"action":"remove","lines":[" "]},{"start":{"row":161,"column":0},"end":{"row":162,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":192,"column":4},"end":{"row":195,"column":41},"action":"remove","lines":["if 'logged_in' not in session:","     ","        flash('To delete a review you will need to log in', 'warning')","        return redirect(url_for('login'))"],"id":66},{"start":{"row":192,"column":0},"end":{"row":192,"column":4},"action":"remove","lines":["    "]},{"start":{"row":191,"column":4},"end":{"row":192,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":191,"column":4},"end":{"row":192,"column":0},"action":"remove","lines":["",""],"id":67}],[{"start":{"row":191,"column":4},"end":{"row":192,"column":0},"action":"remove","lines":["",""],"id":68},{"start":{"row":191,"column":0},"end":{"row":191,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":211,"column":11},"end":{"row":211,"column":12},"action":"remove","lines":[" "],"id":69},{"start":{"row":211,"column":10},"end":{"row":211,"column":11},"action":"remove","lines":["n"]}],[{"start":{"row":211,"column":10},"end":{"row":211,"column":11},"action":"insert","lines":[" "],"id":70},{"start":{"row":211,"column":11},"end":{"row":211,"column":12},"action":"insert","lines":["4"]},{"start":{"row":211,"column":12},"end":{"row":211,"column":13},"action":"insert","lines":["0"]},{"start":{"row":211,"column":13},"end":{"row":211,"column":14},"action":"insert","lines":["4"]}],[{"start":{"row":211,"column":14},"end":{"row":211,"column":15},"action":"insert","lines":[" "],"id":71}],[{"start":{"row":200,"column":38},"end":{"row":201,"column":0},"action":"insert","lines":["",""],"id":72},{"start":{"row":201,"column":0},"end":{"row":201,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":201,"column":0},"end":{"row":201,"column":4},"action":"remove","lines":["    "],"id":73},{"start":{"row":200,"column":38},"end":{"row":201,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":204,"column":86},"end":{"row":205,"column":0},"action":"insert","lines":["",""],"id":74},{"start":{"row":205,"column":0},"end":{"row":205,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":205,"column":4},"end":{"row":205,"column":32},"action":"insert","lines":["print(request.args['query'])"],"id":75}],[{"start":{"row":200,"column":38},"end":{"row":200,"column":39},"action":"insert","lines":["x"],"id":76},{"start":{"row":200,"column":39},"end":{"row":200,"column":40},"action":"insert","lines":["f"]}],[{"start":{"row":200,"column":39},"end":{"row":200,"column":40},"action":"remove","lines":["f"],"id":77},{"start":{"row":200,"column":38},"end":{"row":200,"column":39},"action":"remove","lines":["x"]}],[{"start":{"row":101,"column":58},"end":{"row":102,"column":0},"action":"insert","lines":["",""],"id":78},{"start":{"row":102,"column":0},"end":{"row":102,"column":26},"action":"insert","lines":["                          "]}],[{"start":{"row":102,"column":25},"end":{"row":102,"column":26},"action":"remove","lines":[" "],"id":79},{"start":{"row":102,"column":24},"end":{"row":102,"column":25},"action":"remove","lines":[" "]},{"start":{"row":102,"column":20},"end":{"row":102,"column":24},"action":"remove","lines":["    "]},{"start":{"row":102,"column":16},"end":{"row":102,"column":20},"action":"remove","lines":["    "]},{"start":{"row":102,"column":12},"end":{"row":102,"column":16},"action":"remove","lines":["    "]}],[{"start":{"row":102,"column":8},"end":{"row":102,"column":12},"action":"remove","lines":["    "],"id":81},{"start":{"row":102,"column":4},"end":{"row":102,"column":8},"action":"remove","lines":["    "]},{"start":{"row":102,"column":0},"end":{"row":102,"column":4},"action":"remove","lines":["    "]},{"start":{"row":101,"column":58},"end":{"row":102,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":102,"column":58},"end":{"row":103,"column":0},"action":"insert","lines":["",""],"id":82},{"start":{"row":103,"column":0},"end":{"row":103,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":103,"column":12},"end":{"row":104,"column":43},"action":"insert","lines":["session['username'] = request.form['username']","                session['logged_in'] = True"],"id":83}],[{"start":{"row":103,"column":12},"end":{"row":103,"column":58},"action":"remove","lines":["session['username'] = request.form['username']"],"id":85},{"start":{"row":103,"column":8},"end":{"row":103,"column":12},"action":"remove","lines":["    "]},{"start":{"row":103,"column":4},"end":{"row":103,"column":8},"action":"remove","lines":["    "]},{"start":{"row":103,"column":0},"end":{"row":103,"column":4},"action":"remove","lines":["    "]},{"start":{"row":102,"column":58},"end":{"row":103,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":103,"column":12},"end":{"row":103,"column":16},"action":"remove","lines":["    "],"id":86}],[{"start":{"row":102,"column":58},"end":{"row":103,"column":0},"action":"insert","lines":["",""],"id":87},{"start":{"row":103,"column":0},"end":{"row":103,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":103,"column":12},"end":{"row":103,"column":14},"action":"insert","lines":["''"],"id":88}],[{"start":{"row":103,"column":14},"end":{"row":103,"column":15},"action":"insert","lines":["'"],"id":89}],[{"start":{"row":103,"column":15},"end":{"row":103,"column":16},"action":"insert","lines":[" "],"id":90},{"start":{"row":103,"column":16},"end":{"row":103,"column":17},"action":"insert","lines":["K"]}],[{"start":{"row":103,"column":16},"end":{"row":103,"column":17},"action":"remove","lines":["K"],"id":91}],[{"start":{"row":103,"column":16},"end":{"row":103,"column":17},"action":"insert","lines":["L"],"id":92},{"start":{"row":103,"column":17},"end":{"row":103,"column":18},"action":"insert","lines":["o"]},{"start":{"row":103,"column":18},"end":{"row":103,"column":19},"action":"insert","lines":["g"]},{"start":{"row":103,"column":19},"end":{"row":103,"column":20},"action":"insert","lines":["i"]},{"start":{"row":103,"column":20},"end":{"row":103,"column":21},"action":"insert","lines":["n"]}],[{"start":{"row":103,"column":20},"end":{"row":103,"column":21},"action":"remove","lines":["n"],"id":93},{"start":{"row":103,"column":19},"end":{"row":103,"column":20},"action":"remove","lines":["i"]}],[{"start":{"row":103,"column":19},"end":{"row":103,"column":20},"action":"insert","lines":["s"],"id":94}],[{"start":{"row":103,"column":20},"end":{"row":103,"column":21},"action":"insert","lines":[" "],"id":95},{"start":{"row":103,"column":21},"end":{"row":103,"column":22},"action":"insert","lines":["u"]},{"start":{"row":103,"column":22},"end":{"row":103,"column":23},"action":"insert","lines":["s"]},{"start":{"row":103,"column":23},"end":{"row":103,"column":24},"action":"insert","lines":["e"]},{"start":{"row":103,"column":24},"end":{"row":103,"column":25},"action":"insert","lines":["r"]}],[{"start":{"row":103,"column":25},"end":{"row":103,"column":26},"action":"insert","lines":[" "],"id":96},{"start":{"row":103,"column":26},"end":{"row":103,"column":27},"action":"insert","lines":["i"]},{"start":{"row":103,"column":27},"end":{"row":103,"column":28},"action":"insert","lines":["n"]},{"start":{"row":103,"column":28},"end":{"row":103,"column":29},"action":"insert","lines":["w"]}],[{"start":{"row":103,"column":28},"end":{"row":103,"column":29},"action":"remove","lines":["w"],"id":97}],[{"start":{"row":103,"column":28},"end":{"row":103,"column":29},"action":"insert","lines":[" "],"id":98},{"start":{"row":103,"column":29},"end":{"row":103,"column":30},"action":"insert","lines":["w"]},{"start":{"row":103,"column":30},"end":{"row":103,"column":31},"action":"insert","lines":["h"]},{"start":{"row":103,"column":31},"end":{"row":103,"column":32},"action":"insert","lines":["e"]}],[{"start":{"row":103,"column":31},"end":{"row":103,"column":32},"action":"remove","lines":["e"],"id":99},{"start":{"row":103,"column":30},"end":{"row":103,"column":31},"action":"remove","lines":["h"]},{"start":{"row":103,"column":29},"end":{"row":103,"column":30},"action":"remove","lines":["w"]}],[{"start":{"row":103,"column":29},"end":{"row":103,"column":30},"action":"insert","lines":["a"],"id":100},{"start":{"row":103,"column":30},"end":{"row":103,"column":31},"action":"insert","lines":["f"]},{"start":{"row":103,"column":31},"end":{"row":103,"column":32},"action":"insert","lines":["t"]},{"start":{"row":103,"column":32},"end":{"row":103,"column":33},"action":"insert","lines":["e"]},{"start":{"row":103,"column":33},"end":{"row":103,"column":34},"action":"insert","lines":["r"]}],[{"start":{"row":103,"column":34},"end":{"row":103,"column":35},"action":"insert","lines":[" "],"id":101}],[{"start":{"row":103,"column":35},"end":{"row":103,"column":36},"action":"insert","lines":["r"],"id":102},{"start":{"row":103,"column":36},"end":{"row":103,"column":37},"action":"insert","lines":["e"]},{"start":{"row":103,"column":37},"end":{"row":103,"column":38},"action":"insert","lines":["g"]},{"start":{"row":103,"column":38},"end":{"row":103,"column":39},"action":"insert","lines":["i"]},{"start":{"row":103,"column":39},"end":{"row":103,"column":40},"action":"insert","lines":["s"]},{"start":{"row":103,"column":40},"end":{"row":103,"column":41},"action":"insert","lines":["t"]},{"start":{"row":103,"column":41},"end":{"row":103,"column":42},"action":"insert","lines":["e"]},{"start":{"row":103,"column":42},"end":{"row":103,"column":43},"action":"insert","lines":["r"]},{"start":{"row":103,"column":43},"end":{"row":103,"column":44},"action":"insert","lines":["i"]},{"start":{"row":103,"column":44},"end":{"row":103,"column":45},"action":"insert","lines":["n"]},{"start":{"row":103,"column":45},"end":{"row":103,"column":46},"action":"insert","lines":["g"]}],[{"start":{"row":103,"column":46},"end":{"row":103,"column":47},"action":"insert","lines":[" "],"id":103},{"start":{"row":103,"column":47},"end":{"row":103,"column":48},"action":"insert","lines":["'"]},{"start":{"row":103,"column":48},"end":{"row":103,"column":49},"action":"insert","lines":["'"]},{"start":{"row":103,"column":49},"end":{"row":103,"column":50},"action":"insert","lines":["'"]},{"start":{"row":103,"column":50},"end":{"row":103,"column":51},"action":"insert","lines":["'"]}],[{"start":{"row":103,"column":12},"end":{"row":103,"column":51},"action":"remove","lines":["''' Logs user in after registering ''''"],"id":104},{"start":{"row":103,"column":8},"end":{"row":103,"column":12},"action":"remove","lines":["    "]},{"start":{"row":103,"column":4},"end":{"row":103,"column":8},"action":"remove","lines":["    "]},{"start":{"row":103,"column":0},"end":{"row":103,"column":4},"action":"remove","lines":["    "]},{"start":{"row":102,"column":58},"end":{"row":103,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":103,"column":39},"end":{"row":104,"column":0},"action":"insert","lines":["",""],"id":105},{"start":{"row":104,"column":0},"end":{"row":104,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":104,"column":12},"end":{"row":104,"column":51},"action":"insert","lines":["''' Logs user in after registering ''''"],"id":106}],[{"start":{"row":104,"column":12},"end":{"row":104,"column":15},"action":"remove","lines":["'''"],"id":107},{"start":{"row":104,"column":12},"end":{"row":104,"column":13},"action":"insert","lines":["#"]}],[{"start":{"row":104,"column":45},"end":{"row":104,"column":49},"action":"remove","lines":["''''"],"id":108},{"start":{"row":104,"column":45},"end":{"row":105,"column":0},"action":"insert","lines":["",""]},{"start":{"row":105,"column":0},"end":{"row":105,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":105,"column":8},"end":{"row":105,"column":12},"action":"remove","lines":["    "],"id":109},{"start":{"row":105,"column":4},"end":{"row":105,"column":8},"action":"remove","lines":["    "]},{"start":{"row":105,"column":0},"end":{"row":105,"column":4},"action":"remove","lines":["    "]},{"start":{"row":104,"column":45},"end":{"row":105,"column":0},"action":"remove","lines":["",""]},{"start":{"row":104,"column":44},"end":{"row":104,"column":45},"action":"remove","lines":[" "]}],[{"start":{"row":209,"column":0},"end":{"row":210,"column":0},"action":"insert","lines":["",""],"id":110}],[{"start":{"row":210,"column":0},"end":{"row":227,"column":89},"action":"insert","lines":["@app.route('/search', methods=['POST'])","def search():","    ","    ''' ","    The below line of code creates an index on each of the fields in the collection,","    allowing us to perform a text search on them","    '''","    # mongo.db.recipes.create_index([('description', 'text'), ('name','text'), ('ingredients', 'text')])","    ","    ","    ''' ","    The below line of code drops all indexes on a collection.","    '''","    # mongo.db.recipes.drop_indexes()","    ","    query = request.form.get('query')","    recipes = mongo.db.recipes.find({'$text': {'$search': query}})","    return render_template('recipes.html', recipes=recipes, type='searched', query=query)"],"id":111}],[{"start":{"row":223,"column":16},"end":{"row":223,"column":22},"action":"remove","lines":["ecipes"],"id":112},{"start":{"row":223,"column":16},"end":{"row":223,"column":17},"action":"insert","lines":["g"]}],[{"start":{"row":223,"column":16},"end":{"row":223,"column":17},"action":"remove","lines":["g"],"id":113},{"start":{"row":223,"column":15},"end":{"row":223,"column":16},"action":"remove","lines":["r"]}],[{"start":{"row":223,"column":15},"end":{"row":223,"column":16},"action":"insert","lines":["g"],"id":114},{"start":{"row":223,"column":16},"end":{"row":223,"column":17},"action":"insert","lines":["m"]},{"start":{"row":223,"column":17},"end":{"row":223,"column":18},"action":"insert","lines":["a"]}],[{"start":{"row":223,"column":17},"end":{"row":223,"column":18},"action":"remove","lines":["a"],"id":115},{"start":{"row":223,"column":16},"end":{"row":223,"column":17},"action":"remove","lines":["m"]}],[{"start":{"row":223,"column":16},"end":{"row":223,"column":17},"action":"insert","lines":["a"],"id":116},{"start":{"row":223,"column":17},"end":{"row":223,"column":18},"action":"insert","lines":["m"]},{"start":{"row":223,"column":18},"end":{"row":223,"column":19},"action":"insert","lines":["e"]},{"start":{"row":223,"column":19},"end":{"row":223,"column":20},"action":"insert","lines":["_"]},{"start":{"row":223,"column":20},"end":{"row":223,"column":21},"action":"insert","lines":["r"]},{"start":{"row":223,"column":21},"end":{"row":223,"column":22},"action":"insert","lines":["e"]},{"start":{"row":223,"column":22},"end":{"row":223,"column":23},"action":"insert","lines":["v"]},{"start":{"row":223,"column":23},"end":{"row":223,"column":24},"action":"insert","lines":["i"]},{"start":{"row":223,"column":24},"end":{"row":223,"column":25},"action":"insert","lines":["e"]},{"start":{"row":223,"column":25},"end":{"row":223,"column":26},"action":"insert","lines":["w"]},{"start":{"row":223,"column":26},"end":{"row":223,"column":27},"action":"insert","lines":["s"]}],[{"start":{"row":200,"column":0},"end":{"row":208,"column":131},"action":"remove","lines":["@app.route('/search')","def search():","    orig_query = request.args['query']","    name = mongo.db.game_reviews.find({ \"name\": {\"$regex\": orig_query}})","    genre = mongo.db.game_reviews.find({ \"genre\": {\"$regex\": orig_query}})","    rating = mongo.db.game_reviews.find({ \"rating\": {\"$regex\": orig_query}})","    description = mongo.db.game_reviews.find({ \"description\": {\"$regex\": orig_query}})","    print(request.args['query'])","    return render_template('search.html', name = name, genre = genre, rating = rating, description = description, query=orig_query)"],"id":117},{"start":{"row":199,"column":0},"end":{"row":200,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":218,"column":34},"end":{"row":218,"column":35},"action":"remove","lines":["s"],"id":118},{"start":{"row":218,"column":33},"end":{"row":218,"column":34},"action":"remove","lines":["e"]},{"start":{"row":218,"column":32},"end":{"row":218,"column":33},"action":"remove","lines":["p"]},{"start":{"row":218,"column":31},"end":{"row":218,"column":32},"action":"remove","lines":["i"]},{"start":{"row":218,"column":30},"end":{"row":218,"column":31},"action":"remove","lines":["c"]}],[{"start":{"row":218,"column":30},"end":{"row":218,"column":31},"action":"insert","lines":["v"],"id":119},{"start":{"row":218,"column":31},"end":{"row":218,"column":32},"action":"insert","lines":["i"]},{"start":{"row":218,"column":32},"end":{"row":218,"column":33},"action":"insert","lines":["e"]},{"start":{"row":218,"column":33},"end":{"row":218,"column":34},"action":"insert","lines":["w"]},{"start":{"row":218,"column":34},"end":{"row":218,"column":35},"action":"insert","lines":["s"]}],[{"start":{"row":217,"column":6},"end":{"row":217,"column":11},"action":"remove","lines":["cipes"],"id":120},{"start":{"row":217,"column":6},"end":{"row":217,"column":7},"action":"insert","lines":["c"]},{"start":{"row":217,"column":7},"end":{"row":217,"column":8},"action":"insert","lines":["i"]},{"start":{"row":217,"column":8},"end":{"row":217,"column":9},"action":"insert","lines":["e"]},{"start":{"row":217,"column":9},"end":{"row":217,"column":10},"action":"insert","lines":["w"]}],[{"start":{"row":217,"column":9},"end":{"row":217,"column":10},"action":"remove","lines":["w"],"id":121},{"start":{"row":217,"column":8},"end":{"row":217,"column":9},"action":"remove","lines":["e"]},{"start":{"row":217,"column":7},"end":{"row":217,"column":8},"action":"remove","lines":["i"]},{"start":{"row":217,"column":6},"end":{"row":217,"column":7},"action":"remove","lines":["c"]}],[{"start":{"row":217,"column":6},"end":{"row":217,"column":7},"action":"insert","lines":["c"],"id":122}],[{"start":{"row":217,"column":6},"end":{"row":217,"column":7},"action":"remove","lines":["c"],"id":123}],[{"start":{"row":217,"column":6},"end":{"row":217,"column":7},"action":"insert","lines":["v"],"id":124},{"start":{"row":217,"column":7},"end":{"row":217,"column":8},"action":"insert","lines":["i"]},{"start":{"row":217,"column":8},"end":{"row":217,"column":9},"action":"insert","lines":["e"]},{"start":{"row":217,"column":9},"end":{"row":217,"column":10},"action":"insert","lines":["w"]}],[{"start":{"row":217,"column":10},"end":{"row":217,"column":11},"action":"insert","lines":["s"],"id":125}],[{"start":{"row":218,"column":49},"end":{"row":218,"column":50},"action":"remove","lines":["s"],"id":126},{"start":{"row":218,"column":48},"end":{"row":218,"column":49},"action":"remove","lines":["e"]},{"start":{"row":218,"column":47},"end":{"row":218,"column":48},"action":"remove","lines":["p"]},{"start":{"row":218,"column":46},"end":{"row":218,"column":47},"action":"remove","lines":["i"]},{"start":{"row":218,"column":45},"end":{"row":218,"column":46},"action":"remove","lines":["c"]}],[{"start":{"row":218,"column":45},"end":{"row":218,"column":46},"action":"insert","lines":["v"],"id":127},{"start":{"row":218,"column":46},"end":{"row":218,"column":47},"action":"insert","lines":["i"]},{"start":{"row":218,"column":47},"end":{"row":218,"column":48},"action":"insert","lines":["e"]},{"start":{"row":218,"column":48},"end":{"row":218,"column":49},"action":"insert","lines":["w"]},{"start":{"row":218,"column":49},"end":{"row":218,"column":50},"action":"insert","lines":["s"]}],[{"start":{"row":218,"column":57},"end":{"row":218,"column":58},"action":"remove","lines":["s"],"id":128},{"start":{"row":218,"column":56},"end":{"row":218,"column":57},"action":"remove","lines":["e"]},{"start":{"row":218,"column":55},"end":{"row":218,"column":56},"action":"remove","lines":["p"]},{"start":{"row":218,"column":54},"end":{"row":218,"column":55},"action":"remove","lines":["i"]},{"start":{"row":218,"column":53},"end":{"row":218,"column":54},"action":"remove","lines":["c"]},{"start":{"row":218,"column":52},"end":{"row":218,"column":53},"action":"remove","lines":["e"]},{"start":{"row":218,"column":51},"end":{"row":218,"column":52},"action":"remove","lines":["r"]}],[{"start":{"row":218,"column":51},"end":{"row":218,"column":52},"action":"insert","lines":["r"],"id":129},{"start":{"row":218,"column":52},"end":{"row":218,"column":53},"action":"insert","lines":["e"]},{"start":{"row":218,"column":53},"end":{"row":218,"column":54},"action":"insert","lines":["v"]},{"start":{"row":218,"column":54},"end":{"row":218,"column":55},"action":"insert","lines":["i"]},{"start":{"row":218,"column":55},"end":{"row":218,"column":56},"action":"insert","lines":["e"]},{"start":{"row":218,"column":56},"end":{"row":218,"column":57},"action":"insert","lines":["w"]},{"start":{"row":218,"column":57},"end":{"row":218,"column":58},"action":"insert","lines":["s"]}],[{"start":{"row":214,"column":4},"end":{"row":214,"column":6},"action":"remove","lines":["# "],"id":130}],[{"start":{"row":208,"column":4},"end":{"row":208,"column":6},"action":"remove","lines":["# "],"id":131}],[{"start":{"row":217,"column":25},"end":{"row":217,"column":29},"action":"remove","lines":["cipe"],"id":132},{"start":{"row":217,"column":24},"end":{"row":217,"column":25},"action":"remove","lines":["e"]}],[{"start":{"row":217,"column":24},"end":{"row":217,"column":25},"action":"remove","lines":["s"],"id":133},{"start":{"row":217,"column":23},"end":{"row":217,"column":24},"action":"remove","lines":["r"]}],[{"start":{"row":217,"column":23},"end":{"row":217,"column":24},"action":"insert","lines":["g"],"id":134},{"start":{"row":217,"column":24},"end":{"row":217,"column":25},"action":"insert","lines":["a"]}],[{"start":{"row":217,"column":25},"end":{"row":217,"column":26},"action":"insert","lines":[" "],"id":135}],[{"start":{"row":217,"column":25},"end":{"row":217,"column":26},"action":"remove","lines":[" "],"id":136}],[{"start":{"row":217,"column":25},"end":{"row":217,"column":26},"action":"insert","lines":["m"],"id":137},{"start":{"row":217,"column":26},"end":{"row":217,"column":27},"action":"insert","lines":["e"]}],[{"start":{"row":217,"column":23},"end":{"row":217,"column":27},"action":"remove","lines":["game"],"id":138},{"start":{"row":217,"column":23},"end":{"row":217,"column":35},"action":"insert","lines":["game_reviews"]}],[{"start":{"row":208,"column":14},"end":{"row":208,"column":20},"action":"remove","lines":["ecipes"],"id":139},{"start":{"row":208,"column":13},"end":{"row":208,"column":14},"action":"remove","lines":["r"]}],[{"start":{"row":208,"column":13},"end":{"row":208,"column":14},"action":"insert","lines":["g"],"id":140},{"start":{"row":208,"column":14},"end":{"row":208,"column":15},"action":"insert","lines":["a"]},{"start":{"row":208,"column":15},"end":{"row":208,"column":16},"action":"insert","lines":["m"]},{"start":{"row":208,"column":16},"end":{"row":208,"column":17},"action":"insert","lines":["e"]}],[{"start":{"row":208,"column":13},"end":{"row":208,"column":17},"action":"remove","lines":["game"],"id":141},{"start":{"row":208,"column":13},"end":{"row":208,"column":25},"action":"insert","lines":["game_reviews"]}],[{"start":{"row":214,"column":4},"end":{"row":214,"column":6},"action":"insert","lines":["# "],"id":142}],[{"start":{"row":208,"column":85},"end":{"row":208,"column":95},"action":"remove","lines":["ngredients"],"id":143},{"start":{"row":208,"column":84},"end":{"row":208,"column":85},"action":"remove","lines":["i"]}],[{"start":{"row":208,"column":84},"end":{"row":208,"column":85},"action":"insert","lines":["g"],"id":149},{"start":{"row":208,"column":85},"end":{"row":208,"column":86},"action":"insert","lines":["e"]},{"start":{"row":208,"column":86},"end":{"row":208,"column":87},"action":"insert","lines":["n"]},{"start":{"row":208,"column":87},"end":{"row":208,"column":88},"action":"insert","lines":["r"]},{"start":{"row":208,"column":88},"end":{"row":208,"column":89},"action":"insert","lines":["e"]}],[{"start":{"row":218,"column":73},"end":{"row":218,"column":74},"action":"remove","lines":["d"],"id":150},{"start":{"row":218,"column":72},"end":{"row":218,"column":73},"action":"remove","lines":["e"]}],[{"start":{"row":204,"column":1},"end":{"row":219,"column":0},"action":"remove","lines":["   ''' ","    The below line of code creates an index on each of the fields in the collection,","    allowing us to perform a text search on them","    '''","    mongo.db.game_reviews.create_index([('description', 'text'), ('name','text'), ('genre', 'text')])","    ","    ","    ''' ","    The below line of code drops all indexes on a collection.","    '''","    # mongo.db.game_reviews.drop_indexes()","    ","    query = request.form.get('query')","    reviews = mongo.db.game_reviews.find({'$text': {'$search': query}})","    return render_template('reviews.html', reviews=reviews, type='search', query=query)",""],"id":151}],[{"start":{"row":204,"column":0},"end":{"row":204,"column":1},"action":"remove","lines":[" "],"id":152},{"start":{"row":203,"column":4},"end":{"row":204,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":2777,"scrollleft":0,"selection":{"start":{"row":203,"column":4},"end":{"row":203,"column":4},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":197,"state":"start","mode":"ace/mode/python"}},"timestamp":1593653655887}